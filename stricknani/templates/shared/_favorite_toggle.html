{% import "macros/buttons.html" as buttons %}
{% set icon = 'mdi-heart' if is_favorite else 'mdi-heart-outline' %}
{% set label = _('Unfavorite') if is_favorite else _('Favorite') %}
{% set message = _('Removed from favorites') if is_favorite else _('Added to favorites') %}
{% if variant == 'detail' %}
    {{ buttons.favorite_menu_item(
        label,
        icon=icon,
        attrs='hx-post=\"' ~ favorite_url ~ '\" hx-target=\"closest [data-favorite-toggle]\" hx-swap=\"innerHTML\" data-toast-message=\"' ~ message ~ '\" data-toast-variant=\"' ~ ('info' if is_favorite else 'success') ~ '\" aria-pressed=\"' ~ ('true' if is_favorite else 'false') ~ '\" title=\"' ~ label ~ '\"'
    ) }}
{% else %}
    {% set button_classes = 'inline-flex h-9 w-9 items-center justify-center rounded-full border transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-pink-400 focus:ring-offset-2 backdrop-blur-md shadow-sm' %}
    {% if is_favorite %}
        {% set button_classes = button_classes ~ ' border-pink-500/30 bg-pink-500/20 text-pink-500 hover:bg-pink-500 hover:text-white dark:border-pink-400/30 dark:bg-pink-400/10 dark:text-pink-400 dark:hover:bg-pink-400 dark:hover:text-white' %}
    {% else %}
        {% set button_classes = button_classes ~ ' border-white/20 bg-black/10 text-white/70 hover:bg-white hover:text-pink-500 hover:border-pink-200 dark:bg-white/5 dark:text-white/50 dark:hover:bg-white dark:hover:text-pink-500' %}
    {% endif %}
    <button
        type="button"
        hx-post="{{ favorite_url }}"
        hx-target="this"
        hx-swap="outerHTML"
        data-toast-message="{{ message }}"
        data-toast-variant="{{ 'info' if is_favorite else 'success' }}"
        class="{{ button_classes }}"
        aria-pressed="{{ 'true' if is_favorite else 'false' }}"
        aria-label="{{ label }}"
        title="{{ label }}"
    >
        <span class="mdi {{ icon }}" aria-hidden="true"></span>
        <span class="sr-only">{{ label }}</span>
    </button>
{% endif %}

{% if request and request.headers.get('HX-Request') == 'true' %}
    {% if project_id %}
    <span id="project-{{ project_id }}-favorite-heart" hx-swap-oob="innerHTML">
        {% if is_favorite %}
        <span class="mdi mdi-heart text-pink-500 text-sm" title="{{ _('In favorites') }}"></span>
        {% endif %}
    </span>
    {% elif yarn_id %}
    <span id="yarn-{{ yarn_id }}-favorite-heart" hx-swap-oob="innerHTML">
        {% if is_favorite %}
        <span class="mdi mdi-heart text-pink-500 text-sm" title="{{ _('In favorites') }}"></span>
        {% endif %}
    </span>
    {% endif %}
{% endif %}

