{% macro wysiwyg(input_id, value='', placeholder='', rows=4, disabled=false, markdown_images=false, heading_levels=None, container_class=None, textarea_class=None) %}
{% set heading_levels = heading_levels if heading_levels is not none else [1, 2, 3] %}
<div data-wysiwyg data-wysiwyg-input="{{ input_id }}" class="wysiwyg-container {{ container_class or '' }}">
    <div class="wysiwyg-toolbar">
        <div class="wysiwyg-toolbar-group">
            <button type="button" data-action="bold" title="{{ _('Bold') }}" aria-label="{{ _('Bold') }}">
                <span class="mdi mdi-format-bold"></span>
            </button>
            <button type="button" data-action="italic" title="{{ _('Italic') }}" aria-label="{{ _('Italic') }}">
                <span class="mdi mdi-format-italic"></span>
            </button>
            <button type="button" data-action="underline" title="{{ _('Underline') }}" aria-label="{{ _('Underline') }}">
                <span class="mdi mdi-format-underline"></span>
            </button>
        </div>
        <div class="wysiwyg-toolbar-group">
            {% if 1 in heading_levels %}
            <button type="button" data-action="heading" data-value="1" title="{{ _('Heading 1') }}" aria-label="{{ _('Heading 1') }}">
                <span class="mdi mdi-format-header-1"></span>
            </button>
            {% endif %}
            {% if 2 in heading_levels %}
            <button type="button" data-action="heading" data-value="2" title="{{ _('Heading 2') }}" aria-label="{{ _('Heading 2') }}">
                <span class="mdi mdi-format-header-2"></span>
            </button>
            {% endif %}
            {% if 3 in heading_levels %}
            <button type="button" data-action="heading" data-value="3" title="{{ _('Heading 3') }}" aria-label="{{ _('Heading 3') }}">
                <span class="mdi mdi-format-header-3"></span>
            </button>
            {% endif %}
        </div>
        <div class="wysiwyg-toolbar-group">
            <button type="button" data-action="link" title="{{ _('Add link') }}" aria-label="{{ _('Add link') }}">
                <span class="mdi mdi-link"></span>
            </button>
            <button type="button" data-action="unlink" title="{{ _('Remove link') }}" aria-label="{{ _('Remove link') }}">
                <span class="mdi mdi-link-off"></span>
            </button>
            <button type="button" data-action="image" title="{{ _('Insert image') }}" aria-label="{{ _('Insert image') }}" {% if not markdown_images %}disabled{% endif %}>
                <span class="mdi mdi-image"></span>
            </button>
        </div>
        <div class="wysiwyg-toolbar-group wysiwyg-toolbar-group--right">
            <button type="button" data-action="undo" title="{{ _('Undo') }}" aria-label="{{ _('Undo') }}">
                <span class="mdi mdi-undo"></span>
            </button>
            <button type="button" data-action="redo" title="{{ _('Redo') }}" aria-label="{{ _('Redo') }}">
                <span class="mdi mdi-redo"></span>
            </button>
            <button type="button" data-action="toggleRaw" title="{{ _('Edit Markdown') }}" aria-label="{{ _('Edit Markdown') }}">
                <span class="mdi mdi-language-markdown"></span>
            </button>
        </div>
	    </div>
	    <div class="wysiwyg-content"></div>
	</div>
	<textarea id="{{ input_id }}" name="{{ input_id }}" rows="{{ rows }}" class="wysiwyg-raw textarea textarea-bordered w-full text-sm font-mono hidden {{ textarea_class or '' }}" placeholder="{{ placeholder }}" {% if disabled %}disabled{% endif %} {% if markdown_images %}data-markdown-images="true"{% endif %}>{{ value }}</textarea>
{% endmacro %}

{% macro wysiwyg_scripts() %}
<script type="module">
    import '/static/js/features/wysiwyg_editor.js';
</script>
{% endmacro %}
